<!DOCTYPE html>
<html lang='cs'>
  <head>
    <title>DIPLOMOVÁ PRÁCE</title>
    <meta charset='utf-8'>
    <meta name='description' content=''>
    <meta name='keywords' content=''>
    <meta name='author' content=''>
    <meta name='robots' content='all'>
    <!-- <meta http-equiv='X-UA-Compatible' content='IE=edge'> -->
    <!--leaflet & jquery-->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" 
	integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
	crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.0.1/dist/leaflet.js"></script>
    <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
    <!--Bootstrap a css soubory-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="css/style.css">
    <!--Zoomhome plugin-->
    <link rel="stylesheet" href="./zoomhome/dist/leaflet.zoomhome.css"/>
    <script src="./zoomhome/dist/leaflet.zoomhome.min.js"></script>
    <!--sidebar style-->
    <link rel="stylesheet" href="./css/leaflet-sidebar.css" /> 
	<link rel="stylesheet" href="./css/Control.Coordinates.css" />
    <script src="./js/leaflet-sidebar.js"></script>
	<script src="./js/Control.Coordinates.js"></script>
  </head>
    <body>
        <div id="sidebar" class="sidebar collapsed">
            <!-- Nav tabs -->
            <div class="sidebar-tabs">
                <ul role="tablist">
                    <li><a href="#home" role="tab"><i class="fa fa-eye"></i></a></li>
                    <li><a href="#profile" role="tab"><i class="fa fa-cogs"></i></a></li>
                    <li><a href="#messages" role="tab"><i class="fa fa-cogs"></i></a></li>
				</ul>
                <ul role="tablist">
                    <li><a href="#settings" role="tab"><i class="fa fa-question-circle"></i></a></li>
                </ul>
            </div>
            <!-- Tab panes -->
            <div class="sidebar-content">
              <div class="sidebar-pane" id="home">
                <h1 class="sidebar-header">Rastrová data<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
                  <h4><strong>Základní práce s rastrem</strong></h4>
				  <div class="col-sm-6">
                    <h5><strong>Operace s rastrem</strong></h5>
                    <select id="meta" class="form-control">
                        <option name="inputrastr" value="l7b04">L7 - NIR pásmo</option>
                        <option name="inputrastr" value="l7b05">L7 - SWIR pásmo</option>
                        <option name="inputrastr" value="l7b03">L7 - RED pásmo</option>            
                    </select>
					
					<br><br><h5><strong>Pásmo rastru</strong></h5>
                    <select id="typ" class="form-control">
                        <option name="inputrastr" value="l7b04">L7 - NIR pásmo</option>
                        <option name="inputrastr" value="l7b05">L7 - SWIR pásmo</option>
                        <option name="inputrastr" value="l7b03">L7 - RED pásmo</option>            
                    </select>
					<h5><strong>Vegetační index</strong></h5>
					<select id="" class="form-control">
                        <option name="inputrastr" value="l7b04">NDVI</option>
                        <option name="inputrastr" value="l7b05">NDMI</option>
                        <option name="inputrastr" value="l7b03">SAVI</option>            
                    </select>
				  </div>
				  <div class="col-sm-6">
                    <div class="btn-group-vertical">
                    <br><br><button id="metadata" class="btn btn-primary btn-sm btn-block">METADATA RASTRU</button>
					<button id="transform" class="btn btn-primary btn-sm btn-block">PŘEVÉST NA 8-bit</button>
					<button id="save" class="btn btn-primary btn-sm btn-block">GENEROVAT RASTR</button><br>
					<button id="boundingbox" class="btn btn-primary btn-sm btn-block">ZOBRAZIT RASTR</button><br><br>
					<button id="" class="btn btn-primary btn-sm btn-block">ZOBRAZIT INDEX</button>
					<hr>
                    </div> 
            	  </div>
				  <div id="rasterTable"></div>
				  <h4><strong>Výpočet vegetačního indexu</strong></h4>
                  <div class="col-sm-6"><br>
                    <h5><strong>NDVI RED PÁSMO</strong></h5>
					<h5><strong>NDVI NIR PÁSMO</strong></h5>
					<h5><strong>NDVI VÝSLEDEK</strong></h5>
				  </div>
				  <div class="col-sm-6"><br>
                    <select id="pasmo1">
                        <option value="l7b03">LANDSAT 7</option>
                        <option value="l8b03">LANDSAT 8</option>
                        <option value="s2b04">SENTINEL 2</option>            
                    </select><br>
					<br><select id="pasmo2">
                        <option value="l7b04">LANDSAT 7</option>
                        <option value="l8b04">LANDSAT 8</option>
                        <option value="s2b04">SENTINEL 2</option>            
                    </select><br>
					<br><select id="ndvi">
                        <option value="">NDVI L7</option>
                        <option value="">NDVI L8</option>
                        <option value="">NDVI S2</option>            
                    </select>
					<div class="btn-group-vertical">
                    <br><button id="" class="btn btn-primary btn-sm btn-block">VÝPOČET NDVI IDX</button><hr>
                    </div>
                  </div>
                  <div class="col-sm-6"><br>
                    <h5><strong>NDMI - RED PÁSMO</strong></h5>
					<h5><strong>NDMI - NIR PÁSMO</strong></h5>
					<h5><strong>NDMI - VÝSLEDEK</strong></h5>
					
				  </div>
				  <div class="col-sm-6"><br>
                    <select id="pasmo1">
                        <option value="l7b03">LANDSAT 7</option>
                        <option value="l8b03">LANDSAT 8</option>
                        <option value="s2b04">SENTINEL 2</option>            
                    </select><br>
					<br><select id="pasmo2">
                        <option value="l7b04">LANDSAT 7</option>
                        <option value="l8b04">LANDSAT 8</option>
                        <option value="s2b04">SENTINEL 2</option>            
                    </select><br>
					<br><select id="ndvi">
                        <option value="">NDMI L7</option>
                        <option value="">NDMI L8</option>
                        <option value="">NDMI S2</option>            
                    </select>
					<div class="btn-group-vertical">
                    <br><button id="" class="btn btn-primary btn-sm btn-block">VÝPOČET NDMI IDX</button><hr>
                    </div>
                  </div>
                  <div class="col-sm-6"><br>
                    <h5><strong>SAVI - RED PÁSMO</strong></h5>
					<h5><strong>SAVI - NIR PÁSMO</strong></h5>
					<h5><strong>SAVI - VÝSLEDEK</strong></h5>
					
				  </div>
				  <div class="col-sm-6"><br>
                    <select id="pasmo1" label="NIR">
                        <option value="l7b03">LANDSAT 7</option>
                        <option value="l8b03">LANDSAT 8</option>
                        <option value="s2b04">SENTINEL 2</option>            
                    </select><br>
					<br><select id="pasmo2">
                        <option value="l7b04">LANDSAT 7</option>
                        <option value="l8b04">LANDSAT 8</option>
                        <option value="s2b04">SENTINEL 2</option>            
                    </select><br>
					<br><select id="">
                        <option value="">SAVI L7</option>
                        <option value="">SAVI L8</option>
                        <option value="">SAVI S2</option>            
                    </select>
					<div class="btn-group-vertical">
                    <br><button id="" class="btn btn-primary btn-sm btn-block">VÝPOČET SAVI IDX</button><hr>
                    </div><br>
                  </div>
				  
				</div>
              <div class="sidebar-pane" id="profile">
                <h1 class="sidebar-header">Senzorová data<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
                <h4><strong>Statistické výpočty</strong></h4>
				<div class="col-sm-6">
                    <h5><strong>Lokalizace senzoru</strong></h5>
					<select id="sensorType" class="form-control">
                        <option value="envirodata">senzor enviro</option>
                        <option value="">senzor libelium</option>
                        <option value="">senzor sigfox</option>            
                    </select><br>
				<h5><strong>Měřená veličina</strong></h5>
					<select id="merenaVelicina" class="form-control">
                        <option value="">teplota</option>
                        <option value="">rel. vzdušná vlhokst</option>
                        <option value="">srážky</option>            
                    </select><br>
				</div>
				<div class="col-sm-6">
                    <h5><strong>Časový extent</strong></h5>
					<select id="datetime" class="form-control">
                        <option value="2016-06-13">2016-06-13</option>
                        <option value="2016-06-14">2016-06-14</option>
                        <option value="2016-06-15">2016-06-15</option>            
                    </select><br>
					<h5><strong>Vegetační index</strong></h5>
					<select id="" class="form-control">
                        <option value="ndvi">NDVI</option>
                        <option value="ndmi">NDMI</option>
                        <option value="savivi">SAVI</option>            
                    </select><br>
				</div>
				<div class="col-sm-12">
                    <div class="btn-group-horizontal">
                    <br><button id="displaysenzor" class="btn btn-primary btn-sm btn-block">ZOBRAZIT SENZOR V MAPĚ</button>
					<button id="filterSensorTable" class="btn btn-primary btn-sm btn-block">ATRIBUTOVÁ TABULKA VYBRANÉHO SENZORU</button>
					<button id="calculateMedian" class="btn btn-primary btn-sm btn-block">STATISTIKÉ HODNOTY MĚŘENÉ VELIČINY</button>
					<button id="" class="btn btn-primary btn-sm btn-block">METADATA VEGETAČNÍHO INDEXU</button>
                    </div>     
                </div>
				<div id="displayMedianTable"></div>
				<div class="col-sm-12"><hr>
					<h4><strong>Tvorba korekčního rastru</strong></h4>
					<h5><strong>Název zdrojové tabulky</strong></h5>
					<select id="" class="form-control">
                        <option value="">teplota</option>
                        <option value="">rel. vzdušná vlhokst</option>
                        <option value="">srážky</option>            
                    </select><br>
			        <button id="" class="btn btn-primary btn-sm btn-block">VYTVOŘIT RASTR</button>
                </div>
				</div>
				<div class="col-sm-12"><hr>
					<h4><strong>Vložení hodnot</strong></h4>
					<label>zdrojová tabulka </label><select id="" class="form-control">
                        <option value="">teplota</option>
                        <option value="">rel. vzdušná vlhokst</option>
                        <option value="">srážky</option>            
                    </select>
                    <label>velikost rastrové dlaždice - rozměr x </label><input id="message_id" class="form-control" name="tileX" type="number" />
					<label>velikost rastrové dlaždice - rozměr y </label><input id="message_id" class="form-control" name="tileY" type="number" />
					<label>souřadnice x levého horního rohu </label><input id="message_id" class="form-control" name="upleftcornX" type="number" />
					<label>souřadnice y levého horního rohu </label><input id="message_id" class="form-control" name="upleftcornY" type="number" />
					<label>velikost pixelu x </label><input id="message_id" class="form-control" name="pixelX" type="number" />
					<label>velikost pixelu y </label><input id="message_id" class="form-control" name="pixelY" type="number" />
					<label>souřadnicový systém </label><select id="" class="form-control">
                        <option value="">UTM 33N</option>
                        <option value="">WGS 84</option> 
						<option value="">S-JTSK</option>
                    </select>
					<label>bitová hloubka </label><select id="" class="form-control">
                        <option value="">8-bit</option>
                        <option value="">16-bit</option>            
                    </select>
					<label>hodnota pixelu </label><input id="message_id" class="form-control" name="pixelY" type="number" />
					<div class="btn-group-horizontal">
                    <br><button id="" class="btn btn-primary btn-sm btn-block">VLOŽIT HODNOTY Z MEDIÁNU DO PIXELU</button>
					<button id="" class="btn btn-primary btn-sm btn-block">VYTVOŘIT RASTR Z PRŮMĚRU</button>
                    <hr>
                    </div>
				</div>
			  </div>
			  <div class="sidebar-pane" id="settings">
                <h1 class="sidebar-header">Nápověda<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
              </div>
              <div class="sidebar-pane" id="messages">
			    <h1 class="sidebar-header">Korekční výpočty<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
				<h4><strong>Korekční výpočet</strong></h4>
			  </div>
            </div>
        </div>
        <div id="mapdiv"></div>
		<div id="displaySensorTable"></div>
        <!--Scripty-->
        <script>
            var map = L.map('mapdiv', { zoomControl:false });
            map.setView([49.5938686, 17.2508706], 12);
            var sidebar = L.control.sidebar('sidebar').addTo(map);
            var zoomHome = L.Control.zoomHome({position: 'topright'});
            zoomHome.addTo(map);

            function onEachFeature (feature, layer) {
            layer.bindPopup(feature.properties.name);
            layer.on('click', function(e) {
            map.panTo([feature.geometry.coordinates[1],feature.geometry.coordinates[0]]);
            })};

            var mapBounds = new L.LatLngBounds(
            new L.LatLng(49.5716454, 17.23123875),
            new L.LatLng(49.61717404, 17.28202142));
            var mapMinZoom = 2;
            var mapMaxZoom = 21;

            var defaultni = L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
            maxZoom: 18,
            attribution: 'Štěpán Roubalík | Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
                '<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
                'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
            id: 'mapbox.streets'
            }).addTo(map);

            var baseLayers = {
            "Defaultní": defaultni, 
            };

            var overlays = {
            };
			
					
            L.control.layers(baseLayers, overlays, {collapsed:true}).addTo(map);
            L.control.scale({imperial:false, position:'bottomright'}).addTo(map);
			
			var c = new L.Control.Coordinates();
			c.addTo(map);

			map.on('click', function(e) {
			c.setCoordinates(e);
			});
            
			function getBound(first, third){
                var text1x = first[0], 
                text1y = first[1],
                text2x = third[0],    
                text2y = third[1];
				map.panTo([text1y, text1x]);
                var imageBounds = [[text1y, text1x],[text2y, text2x]];
                var typ = document.getElementById("typ");
                var vybranyTypRastru = typ.options[typ.selectedIndex].value;
                var imageUrl = './data/'+vybranyTypRastru+'.jpg';
                var rastrSnimek = L.imageOverlay(imageUrl, imageBounds).addTo(map);
                }
            //napsat tlačítko které po stisknutí udělá map.removeLayer(rastrSnimek)
            //./data/export/
			//var text1x = $('#text1x').val(), 
                //text1y = $('#text1y').val(),
                //text2x = $('#text2x').val(),    
                //text2y = $('#text2y').val();    
                //console.log($('#text1').val());
                //console.log($('#text2').val());
                //L.marker([text1y, text1x]).addTo(map);
                //L.marker([text2y, text2x]).addTo(map);
				//console.log(vybranyTypRastru);
			
			
    </script>
	
	<!--Ovládací panel pro rastry-->
    <script>
        $("#metadata").click(function(){
            $.ajax({
                url:'rasterProperties.php',
                type:'POST',
                data:{
                    meta: $("#meta").val(),
					},
                success: function(response){
                    $("#rasterTable").html(response);
                }
            });
        });
    </script>
	
	<script>
        $("#filterSensorTable").click(function(){
            $.ajax({
                url:'sensorData.php',
                type:'POST',
                data:{
                    sensorType: $("#sensorType").val(),
					datetime: $("#datetime").val(),
					},
                success: function(response){
                    $("#displaySensorTable").html(response);
                }
            });
        });
    </script>
	<script>
        $("#calculateMedian").click(function(){
            $.ajax({
                url:'sensorDataStatistics.php',
                type:'POST',
                data:{
                    sensorType: $("#sensorType").val(),
					datetime: $("#datetime").val(),
					},
                success: function(response){
                    $("#displayMedianTable").html(response);
                }
            });
        });
    </script>
	
	
	
	<script>
	$("#transform").click(function(){
	$.ajax({
			url:'rasterProperties.php',
			type:'POST',
			data:{
                meta: $("#meta").val(),
                },
            success: function(){
				alert("Rastr byl převeden na barevnou hloubku 8 bitů");
								}
							});
						});
	</script>
	
	<script>
		$("#save").click(function(){
		  $.ajax({
			url:'rasterProperties.php',
			type:'POST',
			data:{
                meta: $("#meta").val(),
                },
            success: function(){
				alert("soubor byl vytvořen");
								}
							});
						});
	</script>
	
	<script>
        $("#boundingbox").click(function(){
        $.ajax({
            url:'displayRaster.php',
            type:'POST',
            data:{
                typ: $("#typ").val(),
                },
                success: function(response){
                    myParser(response);
                }
            });
        });

        function myParser(response) {
          var res = response.split(",");
          var first = res[0].split("((");
          var firstA = first[1].split(" ");
          var third = res[2].split(" ");
          getBound(firstA, third);
		  }
    </script>
	
	<script>
		$("#ndvi").click(function(){
		  $.ajax({
			url:'vegetacni_index.php',
			type:'POST',
			data:{
                pasmo1:$("#pasmo1").val(), 
				pasmo2:$("#pasmo2").val(),
                },
            success: function(){
				alert("index byl vypočítán");
								}
							});
						});
	</script>
	
	<script>
        $("#filterTable").click(function(){
            $.ajax({
                url:'query_sensor_table.php',
                type:'POST',
                data:{
                    datum: $("#datum").val(),
                    sens: $("#sens").val()

                },
                success: function(response){
                    $("#resultTable").html(response);
                }
            });
        });
    </script>
  </body>
</html>